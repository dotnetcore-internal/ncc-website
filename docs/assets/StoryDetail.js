import{A as $,_ as B}from"./ArticleAuthors.vue_vue_type_script_setup_true_lang.js";import{d as S,l as A,k as s,a0 as C,j as L,x as T,y as j,z as N,g as m,a5 as R,o as V,e as i,f as c,u as o,h as z,t as k,M as I,a4 as P}from"./vendor.js";import{u as U}from"./useEmitter.js";import{u as q}from"./uiStore.js";import{c as E}from"./usePageToolkits.js";import{a as F}from"./axios.js";import{_ as G}from"./MarkdownWorker.vue_vue_type_script_setup_true_lang.js";import{B as H}from"./BodyBlock.js";import{T as J}from"./TitleBlock.js";import{_ as K}from"./AnchorElement.vue_vue_type_script_setup_true_lang.js";import"./ContentModels.js";import"./preload-helper.js";import"./index2.js";import"./WaveLoading.js";import"./_plugin-vue_export-helper.js";import"./PlaceholderBlock.vue_vue_type_script_setup_true_lang.js";const O=async function(f,u,l=()=>{}){await F.get(f).then(function(n){u(n.data)}).catch(l)},Q={class:"content-paper relative"},W={class:"absolute top-10 left-5"},X={class:"text-center w-10/12 mx-auto lg:w-4/6 xl:1/2"},Y={class:"px-5 pt-1 text-sm text-gray-500"},ht=S({__name:"StoryDetail",setup(f){const u=I(),l=R(),n=U(),p=q(),d=A(p.locale),h=s(()=>u.params.pathMatch.join("/")),e=C({}),_=s(()=>`about/story/${h.value}/content`),y=async t=>{const a=t!=null?t:d.value,v=`/content/about/story/${h.value}/metadata.${a}.json`;await O(v,r=>{e.id=r.id,e.title=r.title,e.date=r.date,e.author=r.author,e.img=r.img,e.url=r.url,E(e.title,"direct")})},w=s(()=>e.title),g=s(()=>e.date),x=s(()=>e.author),b=(t,a)=>P(t,a,{locales:p}).value,D=L(),M=s(()=>D.value?"#f8f8f8":"#000000");return T(async()=>{n.on("toChangeLocale",async t=>{const a=t;d.value=a.locale;try{await y(a.locale),n.emit("toRerenderMarkdown",{source:_.value,locale:a.locale})}catch(v){await l.push({path:"/404"})}}),await y()}),j(()=>{n.off("toChangeLocale")}),(t,a)=>(V(),N(H,null,{default:m(()=>[i("div",Q,[i("div",W,[c(K,{href:"/about/story","route-name":"about/story",title:t.$t("story"),mode:"h5"},{default:m(()=>[c(o($),{theme:"filled",size:"36",fill:o(M)},null,8,["fill"])]),_:1},8,["title"])]),i("div",X,[c(J,{"with-placeholder":!1,"is-font-black":!1},{default:m(()=>[z(k(o(w)),1)]),_:1}),c(B,{author:o(x)},null,8,["author"]),i("div",Y,k(b(new Date(o(g)),t.$t("_common.date-format"))),1)]),c(G,{source:o(_),i18n:!0,"fallback-locale":"en","final-fallback-fn":()=>o(l).push({path:"/404"})},null,8,["source","final-fallback-fn"])])]),_:1}))}});export{ht as default};

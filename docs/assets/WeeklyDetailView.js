import{d as M,l as D,k as l,a0 as T,x as $,y as A,z as C,g as v,a7 as L,o as S,e as r,f as x,h as V,t as d,u as s,M as N,a4 as R}from"./vendor.js";import{u as W}from"./useEmitter.js";import{u as j}from"./uiStore.js";import{c as U}from"./usePageToolkits.js";import{a as q}from"./axios.js";import{_ as z}from"./MarkdownBlock.vue_vue_type_script_setup_true_lang.js";import{B as E}from"./BodyBlock.js";import{T as F}from"./TitleBlock.js";import"./preload-helper.js";import"./WaveLoading.js";import"./_plugin-vue_export-helper.js";import"./PlaceholderBlock.vue_vue_type_script_setup_true_lang.js";const I=async function(p,u,i=()=>{}){await q.get(p).then(function(c){u(c.data)}).catch(i)},G={class:"text-center w-10/12 mx-auto lg:w-4/6 xl:1/2"},H={class:"w-12 rounded-full overflow-hidden mx-auto mt-8"},J=["src","alt"],K={class:"text-center p-3 border-b-2 border-gray-300 w-72 mx-auto"},O={class:"px-5 pt-1 text-sm text-gray-500"},P={class:"content-paper"},lt=M({__name:"WeeklyDetailView",setup(p){const u=N(),i=L(),c=W(),f=j(),h=D(f.locale),_=l(()=>u.params.pathMatch.join("/")),t=T({}),y=l(()=>`/articles/weekly/${_.value}/content`),w=async e=>{const o=e!=null?e:h.value,n=`/articles/weekly/${_.value}/metadata.${o}.json`;await I(n,a=>{t.id=a.id,t.title=a.title,t.date=a.date,t.author=a.author,t.img=a.img,t.url=a.url,U(t.title,"direct")})},g=l(()=>t.title),b=l(()=>t.date),m=l(()=>t.author),B=(e,o)=>R(e,o,{locales:f}).value;return $(async()=>{c.on("toChangeLocale",async e=>{const o=e;h.value=o.locale;try{await w(o.locale),c.emit("toRerenderMarkdown",{source:y.value,locale:o.locale})}catch(n){await i.push({path:"/404"})}}),await w()}),A(()=>{c.off("toChangeLocale")}),(e,o)=>(S(),C(E,null,{default:v(()=>{var n,a,k;return[r("div",G,[x(F,{"with-placeholder":!1,"is-font-black":!1},{default:v(()=>[V(d(s(g)),1)]),_:1}),r("div",H,[r("img",{src:(n=s(m))==null?void 0:n.avatar,alt:(a=s(m))==null?void 0:a.name},null,8,J)]),r("div",K,d((k=s(m))==null?void 0:k.name),1),r("div",O,d(B(new Date(s(b)),e.$t("_common.date-format"))),1)]),r("div",P,[x(z,{source:s(y),i18n:!0,"fallback-locale":"en","final-fallback-fn":()=>s(i).push({path:"/404"})},null,8,["source","final-fallback-fn"])])]}),_:1}))}});export{lt as default};

import{A as B,_ as A}from"./ArticleAuthors.vue_vue_type_script_setup_true_lang.js";import{d as b,l as C,k as s,a0 as L,j as T,x as S,y as V,z as j,g as m,a7 as N,o as R,e as i,f as n,u as o,h as W,t as w,M as z,a4 as I}from"./vendor.js";import{u as P}from"./useEmitter.js";import{u as U}from"./uiStore.js";import{c as q}from"./usePageToolkits.js";import{a as E}from"./axios.js";import{_ as F}from"./MarkdownBlock.vue_vue_type_script_setup_true_lang.js";import{B as G}from"./BodyBlock.js";import{T as H}from"./TitleBlock.js";import{_ as J}from"./AnchorElement.vue_vue_type_script_setup_true_lang.js";import"./ContentModels.js";import"./preload-helper.js";import"./WaveLoading.js";import"./_plugin-vue_export-helper.js";import"./PlaceholderBlock.vue_vue_type_script_setup_true_lang.js";const K=async function(f,u,c=()=>{}){await E.get(f).then(function(l){u(l.data)}).catch(c)},O={class:"content-paper relative"},Q={class:"absolute top-10 left-5"},X={class:"text-center w-10/12 mx-auto lg:w-4/6 xl:1/2"},Y={class:"px-5 pt-1 text-sm text-gray-500"},pe=b({__name:"WeeklyDetailView",setup(f){const u=z(),c=N(),l=P(),d=U(),p=C(d.locale),h=s(()=>u.params.pathMatch.join("/")),t=L({}),_=s(()=>`/articles/weekly/${h.value}/content`),k=async e=>{const a=e!=null?e:p.value,y=`/articles/weekly/${h.value}/metadata.${a}.json`;await K(y,r=>{t.id=r.id,t.title=r.title,t.date=r.date,t.author=r.author,t.img=r.img,t.url=r.url,q(t.title,"direct")})},v=s(()=>t.title),g=s(()=>t.date),x=s(()=>t.author),D=(e,a)=>I(e,a,{locales:d}).value,M=T(),$=s(()=>M.value?"#f8f8f8":"#000000");return S(async()=>{l.on("toChangeLocale",async e=>{const a=e;p.value=a.locale;try{await k(a.locale),l.emit("toRerenderMarkdown",{source:_.value,locale:a.locale})}catch(y){await c.push({path:"/404"})}}),await k()}),V(()=>{l.off("toChangeLocale")}),(e,a)=>(R(),j(G,null,{default:m(()=>[i("div",O,[i("div",Q,[n(J,{href:"/weekly","route-name":"weekly",title:e.$t("media-weekly"),mode:"h5"},{default:m(()=>[n(o(B),{theme:"filled",size:"36",fill:o($)},null,8,["fill"])]),_:1},8,["title"])]),i("div",X,[n(H,{"with-placeholder":!1,"is-font-black":!1},{default:m(()=>[W(w(o(v)),1)]),_:1}),n(A,{author:o(x)},null,8,["author"]),i("div",Y,w(D(new Date(o(g)),e.$t("_common.date-format"))),1)]),n(F,{source:o(_),i18n:!0,"fallback-locale":"en","final-fallback-fn":()=>o(c).push({path:"/404"})},null,8,["source","final-fallback-fn"])])]),_:1}))}});export{pe as default};

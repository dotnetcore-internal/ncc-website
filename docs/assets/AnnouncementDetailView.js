import{d as B,l as M,k as l,a0 as D,x as T,y as $,z as C,g as y,a7 as L,o as S,e as n,f as g,h as V,t as d,u as s,M as N,a4 as R}from"./vendor.js";import{u as j}from"./useEmitter.js";import{u as U}from"./uiStore.js";import{c as q}from"./usePageToolkits.js";import{a as z}from"./axios.js";import{_ as E}from"./MarkdownBlock.vue_vue_type_script_setup_true_lang.js";import{B as F}from"./BodyBlock.js";import{T as I}from"./TitleBlock.js";import"./preload-helper.js";import"./WaveLoading.js";import"./_plugin-vue_export-helper.js";import"./PlaceholderBlock.vue_vue_type_script_setup_true_lang.js";const G=async function(p,u,i=()=>{}){await z.get(p).then(function(r){u(r.data)}).catch(i)},H={class:"text-center w-10/12 mx-auto lg:w-4/6 xl:1/2"},J={class:"w-12 rounded-full overflow-hidden mx-auto mt-8"},K=["src","alt"],O={class:"text-center p-3 border-b-2 border-gray-300 w-72 mx-auto"},P={class:"px-5 pt-1 text-sm text-gray-500"},Q={class:"content-paper"},lt=B({__name:"AnnouncementDetailView",setup(p){const u=N(),i=L(),r=j(),f=U(),h=M(f.locale),_=l(()=>u.params.pathMatch.join("/")),t=D({}),v=l(()=>`/articles/announcements/${_.value}/content`),w=async e=>{const o=e!=null?e:h.value,c=`/articles/announcements/${_.value}/metadata.${o}.json`;await G(c,a=>{t.id=a.id,t.title=a.title,t.date=a.date,t.author=a.author,t.img=a.img,t.url=a.url,q(t.title,"direct")})},k=l(()=>t.title),b=l(()=>t.date),m=l(()=>t.author),A=(e,o)=>R(e,o,{locales:f}).value;return T(async()=>{r.on("toChangeLocale",async e=>{const o=e;h.value=o.locale;try{await w(o.locale),r.emit("toRerenderMarkdown",{source:v.value,locale:o.locale})}catch(c){await i.push({path:"/404"})}}),await w()}),$(()=>{r.off("toChangeLocale")}),(e,o)=>(S(),C(F,null,{default:y(()=>{var c,a,x;return[n("div",H,[g(I,{"with-placeholder":!1,"is-font-black":!1},{default:y(()=>[V(d(s(k)),1)]),_:1}),n("div",J,[n("img",{src:(c=s(m))==null?void 0:c.avatar,alt:(a=s(m))==null?void 0:a.name},null,8,K)]),n("div",O,d((x=s(m))==null?void 0:x.name),1),n("div",P,d(A(new Date(s(b)),e.$t("_common.date-format"))),1)]),n("div",Q,[g(E,{source:s(v),i18n:!0,"fallback-locale":"en","final-fallback-fn":()=>s(i).push({path:"/404"})},null,8,["source","final-fallback-fn"])])]}),_:1}))}});export{lt as default};

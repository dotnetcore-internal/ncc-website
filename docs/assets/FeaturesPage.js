import{d as N,l as y,aa as R,ab as V,s as D,a0 as j,k as K,x as O,n as E,y as U,a as c,e as r,f as T,g as z,F as _,p as A,i as W,M as q,o as l,b as k,a1 as w,t as F,w as H,u as G}from"./vendor.js";import{u as J}from"./useEmitter.js";import{u as Q}from"./uiStore.js";import{B as X}from"./BodyBlock.js";import{_ as Y}from"./MarkdownWorker.vue_vue_type_script_setup_true_lang.js";import{_ as Z}from"./_plugin-vue_export-helper.js";import"./index2.js";import"./WaveLoading.js";function ee(u,p){let i=Promise.resolve();return function(...v){i=i.then(()=>{u(...v)}),setTimeout(()=>{i=Promise.resolve()},p)}}const te=u=>(A("data-v-d2aaf7ee"),u=u(),W(),u),se={class:"feature-index xl:flex-none"},oe=["href","onClick"],ne={class:"xl:flex-1 overflow-hidden p-4"},ae=["id"],re=["id"],ie={class:"feature-item-title"},ce=te(()=>r("div",{class:"feature-end relative"},null,-1)),le=N({__name:"FeaturesPage",setup(u){const p=q(),i=J(),v=Q(),b=y(null);R(b,([{isIntersecting:t}])=>{g.value=!t});const{y:I}=V();D(I,async t=>{ee(()=>{let o=document.getElementsByTagName("section");for(let e=o.length-1;e>=0;e--)if(o[e].offsetTop<t+112){f.value=o[e].id;break}},1e3)()});const d=j([]),m=j([]),C=t=>{d.splice(0,d.length,...t)},P=t=>{m.splice(0,m.length,...t)},$=t=>`/content/projects/${p.params.id}/features${t?`.${t}`:`.${v.locale}`}.json`,B=async t=>await fetch(t).then(e=>e.json()),g=y(!1),f=y(""),L=t=>{const o=document.getElementById(`${t}-anchor`);o&&o.scrollIntoView({behavior:"smooth"})},M=K(()=>{const t=m.reduce((s,n)=>{const{group:a,...h}=n;return s[a!=null?a:"unclassified-1"]||(s[a!=null?a:"unclassified-1"]=[]),s[a].push(h),s},{}),o=Object.keys(t).sort((s,n)=>{const a=d.find(x=>x.id===s),h=d.find(x=>x.id===n);return a&&h?a.sort-h.sort:0}),e={};for(const s of o){const n=t[s];e[s]||(e[s]=[]);for(const a of n)e[s].push(a)}return e}),S=t=>d.find(o=>o.id===t);return O(()=>{const t=$();B(t).then(o=>{var e,s;C(o.groups),P(o.features),f.value=(s=(e=o.features[0])==null?void 0:e.id)!=null?s:""}),i.on("toChangeLocale",async o=>{const e=o;await E(()=>{const s=$(e.locale);B(s).then(n=>{C(n.groups),P(n.features)})})}),E(()=>{i.emit("toChangeProjectPaper",{paper:"features"})})}),U(()=>{i.off("toChangeLocale")}),(t,o)=>(l(),c(_,null,[r("div",{class:"absolute -mt-20 w-0.5 h-0.5 bg-transparent",ref_key:"focusedRef",ref:b},null,512),T(X,{class:"xl:flex overflow-hidden"},{default:z(()=>[r("div",se,[r("div",{class:k({fixed:g.value,"top-28":g.value})},[(l(!0),c(_,null,w(G(M),(e,s)=>(l(),c("div",{key:s,class:"feature-index-group"},[r("div",{class:k(["feature-index-group-title overflow-hidden",{"feature-index-group-title-hide":S(s).hidden}])},F(S(s).title),3),r("ul",null,[(l(!0),c(_,null,w(e,n=>(l(),c("li",{key:n.id,class:"feature-index-text"},[r("a",{href:`#${n.id}`,class:k({"text-pink-500":f.value===n.id,"text-black dark:text-white":f.value!==n.id,"feature-index-current":f.value===n.id}),onClick:H(a=>L(n.id),["prevent"])},F(n.title),11,oe)]))),128))])]))),128))],2)]),r("div",ne,[(l(!0),c(_,null,w(m,e=>(l(),c("section",{key:e.id,id:e.id,class:"feature-item"},[r("div",{class:"absolute -mt-28 bg-transparent",id:`${e.id}-anchor`},null,8,re),r("div",ie,F(e.title),1),T(Y,{source:`projects/${G(p).params.id}/features/${e.id}`,i18n:!0,"fallback-locale":"en","include-file-extension":!0,"file-extension":".md","redirect-to404":!1},null,8,["source"])],8,ae))),128))])]),_:1}),ce],64))}});const ge=Z(le,[["__scopeId","data-v-d2aaf7ee"]]);export{ge as default};

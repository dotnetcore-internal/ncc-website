import{_ as G}from"./preload-helper.js";import{d as M,l as x,aa as N,ab as O,s as A,a2 as S,k as K,x as U,n as T,y as z,a as c,f as y,g as I,F as _,M as W,o as l,e as a,b as k,a3 as w,t as F,w as q,u as L}from"./vendor.js";import{u as H}from"./useEmitter.js";import{u as J}from"./uiStore.js";import{B as Q}from"./BodyBlock.js";import{_ as X}from"./PlaceholderBlock.vue_vue_type_script_setup_true_lang.js";import{_ as Y}from"./MarkdownRenderer.vue_vue_type_script_setup_true_lang.js";import{_ as Z}from"./_plugin-vue_export-helper.js";function ee(b,f){let i=Promise.resolve();return function(...h){i=i.then(()=>{b(...h)}),setTimeout(()=>{i=Promise.resolve()},f)}}const te={class:"feature-index xl:flex-none"},se=["href","onClick"],oe={class:"xl:flex-1 overflow-hidden p-4"},ne=["id"],re=["id"],ae={class:"feature-item-title"},ie=M({__name:"FeaturesPage",setup(b){const f=W(),i=H(),h=J(),P=x(null);N(P,([{isIntersecting:e}])=>{v.value=!e});const{y:R}=O();A(R,async e=>{ee(()=>{let o=document.getElementsByTagName("section");for(let t=o.length-1;t>=0;t--)if(o[t].offsetTop<e+112){d.value=o[t].id;break}},1e3)()});const u=S([]),p=S([]),C=e=>{u.splice(0,u.length,...e)},$=e=>{p.splice(0,p.length,...e)},B=e=>`../../../content/projects/${f.params.id}/features${e?`.${e}`:`.${h.locale}`}.json`,j=async e=>await G(()=>import(e),[],import.meta.url),v=x(!1),d=x(""),V=e=>{const o=document.getElementById(`${e}-anchor`);o&&o.scrollIntoView({behavior:"smooth"})},D=K(()=>{const e=p.reduce((s,n)=>{const{group:r,...m}=n;return s[r!=null?r:"unclassified-1"]||(s[r!=null?r:"unclassified-1"]=[]),s[r].push(m),s},{}),o=Object.keys(e).sort((s,n)=>{const r=u.find(g=>g.id===s),m=u.find(g=>g.id===n);return r&&m?r.sort-m.sort:0}),t={};for(const s of o){const n=e[s];t[s]||(t[s]=[]);for(const r of n)t[s].push(r)}return t}),E=e=>u.find(o=>o.id===e);return U(()=>{const e=B();j(e).then(o=>{var t,s;C(o.groups),$(o.features),d.value=(s=(t=o.features[0])==null?void 0:t.id)!=null?s:""}),i.on("toChangeLocale",async o=>{const t=o;await T(()=>{const s=B(t.locale);j(s).then(n=>{C(n.groups),$(n.features)})})}),T(()=>{i.emit("toChangeProjectPaper",{paper:"features"})})}),z(()=>{i.off("toChangeLocale")}),(e,o)=>(l(),c(_,null,[y(Q,{class:"feature-paper xl:flex overflow-hidden"},{default:I(()=>[a("div",te,[a("div",{class:k({fixed:v.value,"top-28":v.value})},[(l(!0),c(_,null,w(L(D),(t,s)=>(l(),c("div",{key:s,class:"feature-index-group"},[a("div",{class:k(["feature-index-group-title overflow-hidden",{"feature-index-group-title-hide":E(s).hidden}])},F(E(s).title),3),a("ul",null,[(l(!0),c(_,null,w(t,n=>(l(),c("li",{key:n.id,class:"feature-index-text"},[a("a",{href:`#${n.id}`,class:k({"text-pink-500":d.value===n.id,"text-black dark:text-white":d.value!==n.id,"feature-index-current":d.value===n.id}),onClick:q(r=>V(n.id),["prevent"])},F(n.title),11,se)]))),128))])]))),128))],2)]),a("div",oe,[a("div",{class:"absolute top-56 w-0.5 h-0.5 bg-transparent",ref_key:"focusedRef",ref:P},null,512),(l(!0),c(_,null,w(p,t=>(l(),c("section",{key:t.id,id:t.id,class:"feature-item"},[a("div",{class:"absolute -mt-28 bg-transparent",id:`${t.id}-anchor`},null,8,re),a("div",ae,F(t.title),1),y(Y,{source:`projects/${L(f).params.id}/features/${t.id}`,i18n:!0,"fallback-locale":"en","include-file-extension":!0,"file-extension":".md","retry-timeout":"1000","redirect-to404":!1},null,8,["source"])],8,ne))),128))])]),_:1}),y(X,{height:"20px"})],64))}});const he=Z(ie,[["__scopeId","data-v-d932c84e"]]);export{he as default};
